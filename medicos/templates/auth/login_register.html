            {% if register_form.errors %}
              <div class="alert alert-danger mt-2">
                {% for field, errors in register_form.errors.items %}
                  {% for error in errors %}
                    <div>{{ error }}</div>
                  {% endfor %}
                {% endfor %}
              </div>
            {% endif %}
{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>prj_medicos - Acesso ao Sistema</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <style>
      html, body { height: 100%; }
      body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; margin: 0; padding: 0; }
      .login-card { background: white; border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; }
      .login-header { background: linear-gradient(45deg, #667eea, #764ba2); color: white; padding: 2rem; text-align: center; }
      .login-form { padding: 2rem; }
      .btn-login { background: linear-gradient(45deg, #667eea, #764ba2); border: none; border-radius: 25px; padding: 12px 30px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; }
      .form-control { border-radius: 25px; padding: 12px 20px; border: 2px solid #e9ecef; transition: all 0.3s ease; }
      .form-control:focus { border-color: #667eea; box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25); }
    </style>
</head>
<body class="bg-light">
<main class="login-container d-flex align-items-center justify-content-center" style="min-height: 100vh;">
  <div class="login-card animate__animated animate__fadeInDown mx-auto" style="max-width: 500px; width: 100%; background: #fff; border-radius: 18px; box-shadow: 0 8px 32px rgba(102,126,234,0.10); overflow: hidden;">
    <div class="login-header" style="background: #fff; color: #333; padding: 2.2rem 2rem 1.2rem 2rem; text-align: center; border-bottom: 1px solid #f0f0f0;">
      <img src="https://cdn-icons-png.flaticon.com/512/3209/3209265.png" alt="Logo" style="width: 56px; height: 56px; margin-bottom: 0.5rem;">
      <h2 class="mb-1" style="font-weight: 700; letter-spacing: 1px; color: #667eea;">prj_medicos</h2>
      <p class="mb-0" style="font-size: 1.05rem; color: #888;">Acesso ao sistema</p>
    </div>
    <div class="login-form p-4">
      {% if messages %}
        {% for message in messages %}
          <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
      {% endif %}
      <form id="loginForm" method="post" autocomplete="off" {% if show_register %}class="d-none"{% endif %}>
        {% csrf_token %}
        <input type="hidden" name="action" value="login">
        <div class="row justify-content-center">
          <div class="col-12 col-md-10 mx-auto">
            <div class="mb-3 text-start">
              <label class="form-label fw-semibold">E-mail</label>
              <input type="email" name="email" class="form-control" id="id_email_login" required value="{{ login_form.email.value|default:'' }}">
              {% for error in login_form.email.errors %}
                <div class="text-danger small">{{ error }}</div>
              {% endfor %}
            </div>
            <div class="mb-3 text-start">
              <label for="id_password_login" class="form-label fw-semibold">Senha</label>
              <input type="password" name="password" class="form-control" id="id_password_login" required value="">
              {% for error in login_form.password.errors %}
                <div class="text-danger small">{{ error }}</div>
              {% endfor %}
            </div>
            {% if login_form.non_field_errors %}
              <div class="alert alert-danger mt-2">
                {{ login_form.non_field_errors }}
              </div>
            {% endif %}
            <div class="d-grid gap-2 mb-2">
              <button type="submit" class="btn btn-login" style="background: linear-gradient(45deg, #667eea, #764ba2); color: #fff;">Entrar</button>
              <button type="button" class="btn btn-login" style="background: linear-gradient(45deg, #4285f4, #34a853, #fbbc05, #ea4335); color: #fff;">
                <i class="fab fa-google me-2"></i> Entrar com Google
              </button>
            </div>
            <div class="d-flex flex-column flex-md-row justify-content-between align-items-center mt-3 gap-2">
              <div>
                <a href="#" class="link-secondary small" data-bs-toggle="modal" data-bs-target="#resetModal">Esqueceu a senha?</a>
                <span class="mx-2">|</span>
                <a href="{% url 'auth:resend_activation' %}" class="link-secondary small">Reenviar ativação</a>
              </div>
              <span class="text-muted" style="font-size: 0.95rem;">Não tem conta?
                <a href="#" class="link-primary ms-1 fw-bold" data-toggle="register">Cadastre-se</a>
              </span>
            </div>
          </div>
        </div>
      </form>
      <form id="registerForm" method="post" action="{% url 'auth:register' %}" autocomplete="off" {% if not show_register %}class="d-none"{% endif %}>
        {% csrf_token %}
        <input type="hidden" name="action" value="register">
        <div class="row justify-content-center">
          <div class="col-12 col-md-10 mx-auto">
            {# Bloco para exibir todos os erros do formulário de registro #}
            {% if register_form.errors %}
              <div class="alert alert-danger mt-2">
                <b>Erros no cadastro:</b>
                <ul class="mb-0">
                  {% for field, errors in register_form.errors.items %}
                    {% for error in errors %}
                      <li>{{ error }}</li>
                    {% endfor %}
                  {% endfor %}
                </ul>
              </div>
              <script>console.error('Erros no registro:', {{ register_form.errors.as_json|safe }});</script>
            {% endif %}
            <div class="mb-3">
              <label for="id_first_name" class="form-label fw-semibold">Nome</label>
              <input type="text" name="first_name" class="form-control" id="id_first_name" required value="{{ register_form.first_name.value|default:'' }}">
              {% for error in register_form.first_name.errors %}
                <div class="text-danger small">{{ error }}</div>
              {% endfor %}
            </div>
            <div class="mb-3">
              <label for="id_last_name" class="form-label fw-semibold">Sobrenome</label>
              <input type="text" name="last_name" class="form-control" id="id_last_name" required value="{{ register_form.last_name.value|default:'' }}">
              {% for error in register_form.last_name.errors %}
                <div class="text-danger small">{{ error }}</div>
              {% endfor %}
            </div>
            <div class="mb-3">
              <label for="id_email_register" class="form-label fw-semibold">E-mail</label>
              <input type="email" name="email" class="form-control" id="id_email_register" required value="{{ register_form.email.value|default:'' }}">
              {% for error in register_form.email.errors %}
                <div class="text-danger small">{{ error }}</div>
              {% endfor %}
            </div>
            <div class="mb-3">
              <label for="id_password1" class="form-label fw-semibold">Senha</label>
              <input type="password" name="password1" class="form-control" id="id_password1" required>
              {% for error in register_form.password1.errors %}
                <div class="text-danger small">{{ error }}</div>
              {% endfor %}
            </div>
            <div class="mb-3">
              <label for="id_password2" class="form-label fw-semibold">Confirme a senha</label>
              <input type="password" name="password2" class="form-control" id="id_password2" required>
              {% for error in register_form.password2.errors %}
                <div class="text-danger small">{{ error }}</div>
              {% endfor %}
            </div>
            <div class="d-grid mb-2">
              <button type="submit" class="btn btn-success btn-login">Registrar</button>
            </div>
            <div class="text-center mt-2">
              <a href="#" class="link-secondary fw-bold" data-toggle="login">Já possui conta? Entrar</a>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</main>
<!-- Modal para reset de senha -->
<div class="modal fade" id="resetModal" tabindex="-1" aria-labelledby="resetModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-warning-subtle border-0">
        <h5 class="modal-title" id="resetModalLabel"><i class="bi bi-arrow-repeat"></i> Redefinir senha</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form method="post" action="{% url 'auth:password_reset' %}" autocomplete="off">
          {% csrf_token %}
          <div class="mb-3">
            <label for="id_email_reset" class="form-label fw-semibold">E-mail</label>
            <input type="email" name="email" class="form-control" id="id_email_reset" required value="{{ password_reset_form.email.value|default:'' }}">
            {% for error in password_reset_form.email.errors %}
              <div class="text-danger small">{{ error }}</div>
            {% endfor %}
          </div>
          <div class="d-grid gap-2">
            <button type="submit" class="btn btn-warning btn-lg">Enviar link de redefinição</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  document.querySelector('.login-form').addEventListener('click', function(e) {
    if (e.target && e.target.matches('[data-toggle="register"]')) {
      e.preventDefault();
      document.getElementById('loginForm').classList.add('d-none');
      document.getElementById('registerForm').classList.remove('d-none');
    }
    if (e.target && e.target.matches('[data-toggle="login"]')) {
      e.preventDefault();
      document.getElementById('registerForm').classList.add('d-none');
      document.getElementById('loginForm').classList.remove('d-none');
    }
  });
});
</script>
</body>
</html>
