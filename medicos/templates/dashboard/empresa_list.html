{% extends 'layouts/base_cenario_0.html' %}
{% load static %}

{% block title %}Empresas 123{% endblock %}
{% block content %}
<style>
  body { background-color: #181c24 !important; }
  .form-control, .form-select { background: #232a36; color: #e3f2fd; border: 1px solid #283a5c; }
  .form-label { color: #b0bec5; }
</style>
<div class="container pt-3 pb-4">
  <div class="row justify-content-center mb-4">
    <div class="col-lg-8 col-md-10 col-12">
      <div class="card shadow border-0 mb-4" style="border-radius: 18px; background: #232a36; border: 1px solid #283a5c;">
        <div class="card-body">
          <h2 class="mb-4" style="color: #e3f2fd;">Empresas123</h2>
          <form method="get" class="mb-3">
            <div class="row g-2 align-items-end">
              <div class="col-md-4">
                <label class="form-label">{{ empresa_filter.form.name.label }}</label>
                {{ empresa_filter.form.name }}
              </div>
              <div class="col-md-3">
                <label for="id_ordering" class="form-label">Ordenar por</label>
                <select name="ordering" id="id_ordering" class="form-select">
                  <option value="name" {% if request.GET.ordering == 'name' %}selected{% endif %}>Nome (A-Z)</option>
                  <option value="-name" {% if request.GET.ordering == '-name' %}selected{% endif %}>Nome (Z-A)</option>
                  <option value="cnpj" {% if request.GET.ordering == 'cnpj' %}selected{% endif %}>CNPJ (Crescente)</option>
                  <option value="-cnpj" {% if request.GET.ordering == '-cnpj' %}selected{% endif %}>CNPJ (Decrescente)</option>
                  <option value="regime_tributario" {% if request.GET.ordering == 'regime_tributario' %}selected{% endif %}>Regime Tributário (A-Z)</option>
                  <option value="-regime_tributario" {% if request.GET.ordering == '-regime_tributario' %}selected{% endif %}>Regime Tributário (Z-A)</option>
                </select>
              </div>
              <div class="col-md-2">
                <button type="submit" class="btn btn-outline-primary">Filtrar</button>
              </div>
            </div>
          </form>
          <div class="table-responsive d-flex justify-content-center">
            <table class="table table-striped align-middle mb-0" style="font-size: 1.05rem; max-width: 700px; margin: 0 auto; background: #232a36; color: #e3f2fd;">
              <thead style="background-color: #22304a; color: #42a5f5;">
                <tr>
                  <th>Razão Social</th>
                  <th>CNPJ</th>
                  <th>Regime Tributário</th>
                  <th class="text-center">Ação</th>
                </tr>
              </thead>
              <tbody>
                {% for empresa in empresas %}
                <tr {% if empresa.id == empresa_id_atual %}style="background-color: #22304a;"{% endif %}>
                  <td class="fw-semibold">{{ empresa.name }}</td>
                  <td><span class="text-monospace">{{ empresa.cnpj }}</span></td>
                  <td>{{ empresa.regime_tributario }}</td>
                  <td class="text-center">
                    {% if empresa.id != empresa_id_atual %}
                      <form method="get" action="{% url 'medicos:dashboard' %}" style="display:inline;">
                        <input type="hidden" name="empresa_id" value="{{ empresa.id }}">
                        <button type="submit" class="btn btn-outline-primary btn-sm px-3" style="border-color: #42a5f5; color: #42a5f5;">Selecionar</button>
                      </form>
                    {% else %}
                      <span class="badge px-3 py-2" style="background-color: #1976d2; color: #fff;">Selecionada</span>
                    {% endif %}
                  </td>
                </tr>
                {% empty %}
                <tr>
                  <td colspan="4" class="text-center text-muted">Nenhuma empresa encontrada.</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
</div>
{% endblock %}
